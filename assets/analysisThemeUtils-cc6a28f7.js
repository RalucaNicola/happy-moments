import{i as tt}from"./Segment-42160f38.js";import{cQ as y,Z as D,jY as et,k2 as $,i7 as nt,k3 as at,aK as st,k4 as it,bB as rt,dI as ot,b$ as ct,k5 as ut,k6 as ht,k7 as T,aX as F,k8 as C}from"./index-3fca1522.js";function lt(t){let{r:e,g:n,b:a,a:s}=t;return s<1&&(e=Math.round(s*e+255*(1-s)),n=Math.round(s*n+255*(1-s)),a=Math.round(s*a+255*(1-s))),new y({r:e,g:n,b:a})}function ft(t){const{r:e,g:n,b:a}=lt(t);return .2126*e+.7152*n+.0722*a}const kt={readOnly:!0,get(){return tt(this.view)}};var G;(function(t){t[t.Auto=0]="Auto",t[t.Euclidean=1]="Euclidean",t[t.Geodesic=2]="Geodesic"})(G||(G={}));function I(t){if(!t)return null;if(nt(t)&&t.wkid){const e=at[t.wkid];if(e)return e}if(t.wkt){const e=Mt(t.wkt);if(e)return e}return null}function Mt(t){const e=it.exec(t);if(!e||e.length!==2)return null;const n=e[1].split(",");if(!n||n.length<3)return null;const a=parseFloat(n[1]),s=parseFloat(n[2]);return isNaN(a)||isNaN(s)?null:{a,f:s===0?0:1/s}}function dt(t){const e=I(t??st.WGS84);if(pt(e))return e;const n=e.a*(1-e.f);return Object.assign(e,{b:n,eSq:1-(n/e.a)**2,radius:(2*e.a+n)/3,densificationRatio:1e4/((2*e.a+n)/3)})}function pt(t){return t!=null&&"b"in t&&"eSq"in t&&"radius"in t}function mt(t){return I(t)!==null}function At(t,e="meters"){if(!t)throw new D("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(t.some(a=>!mt(a.spatialReference)))throw new D("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const n=[];for(let a=0;a<t.length;a++){const s=t[a],{spatialReference:m}=s,g=s.type==="polyline"?s.paths:s.rings;let r=0;for(let v=0;v<g.length;v++){const o=g[v];let f=0;for(let M=1;M<o.length;M++){const _=o[M-1][0],z=o[M][0],R=o[M-1][1],u=o[M][1];if(R!==u||_!==z){const c=new $t;gt(c,[_,R],[z,u],m),f+=c.distance}}r+=f}r=et(r,"meters",e),n.push(r)}return n}class $t{constructor(e=0,n,a){this.distance=e,this.azimuth=n,this.reverseAzimuth=a}}function gt(t,e,n,a){const s=e[0]*$,m=e[1]*$,g=n[0]*$,r=n[1]*$,{a:v,b:o,f,radius:M}=dt(a),_=g-s,z=Math.atan((1-f)*Math.tan(m)),R=Math.atan((1-f)*Math.tan(r)),u=Math.sin(z),c=Math.cos(z),w=Math.sin(R),h=Math.cos(R);let S,b,d,i,k,q,A,N,P,U,j=1e3,l=_;do{if(A=Math.sin(l),N=Math.cos(l),d=Math.sqrt(h*A*(h*A)+(c*w-u*h*N)*(c*w-u*h*N)),d===0)return t.distance=0,t.azimuth=void 0,t.reverseAzimuth=void 0,t;k=u*w+c*h*N,q=Math.atan2(d,k),P=c*h*A/d,b=1-P*P,i=k-2*u*w/b,isNaN(i)&&(i=0),U=f/16*b*(4+f*(4-3*b)),S=l,l=_+(1-U)*f*P*(q+U*d*(i+U*k*(2*i*i-1)))}while(Math.abs(l-S)>1e-12&&--j>0);if(j===0){const Z=M,H=Math.acos(Math.sin(m)*Math.sin(r)+Math.cos(m)*Math.cos(r)*Math.cos(g-s))*Z,x=g-s,J=Math.sin(x)*Math.cos(r),L=Math.cos(m)*Math.sin(r)-Math.sin(m)*Math.cos(r)*Math.cos(x),V=Math.atan2(J,L);return t.azimuth=V/$,t.distance=H,t.reverseAzimuth=void 0,t}const p=b*(v*v-o*o)/(o*o),E=p/1024*(256+p*(p*(74-47*p)-128)),W=o*(1+p/16384*(4096+p*(p*(320-175*p)-768)))*(q-E*d*(i+E/4*(k*(2*i*i-1)-E/6*i*(4*d*d-3)*(4*i*i-3)))),X=Math.atan2(h*Math.sin(l),c*w-u*h*Math.cos(l)),Y=Math.atan2(c*Math.sin(l),c*w*Math.cos(l)-u*h);return t.azimuth=X/$,t.distance=W,t.reverseAzimuth=Y/$,t}function Nt(t,e){if(rt(e,0,0,0),t.length>0){for(let n=0;n<t.length;++n)ot(e,e,t[n]);ct(e,e,1/t.length)}}function Pt(t,e,n,a){a.projectToRenderScreen(t,O),a.projectToRenderScreen(e,B),ut(n,wt,vt),ht(n,n)}const O=T(),vt=O,B=T(),wt=B;let Ut=class{constructor(e=null){this.spatialReference=e}get spatialReference(){return this._spatialReference}set spatialReference(e){e!==this._spatialReference&&(this._spatialReference=e,this._updateNormalizationFactors())}normalizeDistance(e){return e*this._metersPerDistanceUnit}normalizeElevation(e){return e*this._metersPerElevationUnit}normalizeArea(e){return e*this._squareMetersPerAreaUnit}_updateNormalizationFactors(){this._metersPerDistanceUnit=F(this._spatialReference,1),this._metersPerElevationUnit=F(this._spatialReference,1),this._squareMetersPerAreaUnit=this._metersPerDistanceUnit*this._metersPerDistanceUnit}};function K(t,e){const n=t.a*e;return ft(t)>225?new y([0,0,0,n]):new y([255,255,255,n])}function Q(t,e){const n=new y(t);return n.a*=e,n}function _t(t=1){return Q(C.analysisTheme.accentColor,t)}function qt(t=1){return K(_t(),t)}function zt(t=1){return Q(C.analysisTheme.textColor,t)}function Et(t=1){return K(zt(),t)}export{mt as M,zt as a,gt as b,Nt as c,kt as d,G as e,Pt as f,_t as i,Et as s,Ut as t,qt as u,$t as v,At as y};
